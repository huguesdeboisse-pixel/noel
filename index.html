<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ñ–ûYEUX –ùO√ãL ‚Äî –í–æ—Å—Ç–æ—á–Ω—ã–π —Å—Ç–∏–ª—å</title>
<style>
  body {
    margin:0; height:100%; color:#fff; font-family:'Cinzel','Georgia','Comic Sans MS',serif;
    background:radial-gradient(circle at center,#b00000 0%,#5c0000 60%,#000 100%);
    overflow:hidden; text-align:center;
  }
  .frame {position:fixed;inset:0;border:20px ridge gold;box-shadow:0 0 80px gold inset,0 0 50px red inset;pointer-events:none;}
  h1 {margin:40px 0;font-size:64px;color:#fffbe6;text-shadow:0 0 20px gold,0 0 40px red,0 0 80px gold;letter-spacing:4px;}
  .grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;max-width:900px;margin:0 auto;}
  .nameBtn {background:conic-gradient(from 0deg,gold,red,gold,red);border:4px double #fff8dc;border-radius:18px;padding:14px;font-size:20px;font-weight:700;cursor:pointer;color:#300;text-shadow:0 0 8px #fff;box-shadow:0 0 20px #fff;}
  .nameBtn:hover{filter:brightness(1.3) saturate(1.5);}
  .note {position:fixed;top:100px;right:20px;background:linear-gradient(180deg,#fff6d6,#ffe6ff);color:#300;padding:12px 14px;border:6px ridge gold;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,.35);max-width:240px;}
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:10;}
  .modal.open{display:flex;}
  .dialog{background:radial-gradient(circle,#fff7d6,#ffe9ff);padding:30px;border:8px ridge gold;border-radius:20px;color:#500;text-align:center;box-shadow:0 0 40px gold;}
  .dialog strong{color:#b0005a;font-size:26px;}
  .closeBtn{margin-top:10px;border:none;background:linear-gradient(135deg,gold,orange);padding:12px 18px;font-weight:900;border-radius:16px;cursor:pointer;}
  .decor{position:fixed;z-index:-1;opacity:.9;}
  .left-decor{left:0;bottom:0;width:300px;}
  .right-decor{right:0;top:0;width:300px;}
  .tree{bottom:0;left:50%;transform:translateX(-50%);width:400px;}
  .audio-toggle{position:fixed;right:16px;bottom:16px;z-index:20;border:0;border-radius:50%;width:56px;height:56px;cursor:pointer;background:radial-gradient(circle,#fff,#ffe07a);box-shadow:0 0 18px gold,inset 0 0 12px #fff;color:#3b0000;font-size:22px;}
</style>
</head>
<body>
<div class="frame"></div>
<h1>–ñ–ûYEUX –ùO√ãL</h1>
<img src="b6127f72-7660-40b4-966b-d417f5e93deb.png" class="decor left-decor" alt="Vierge et enfant">
<img src="dc05b10f-fb2c-4140-a923-d0c98961cee1.png" class="decor right-decor" alt="Ange dor√©">
<img src="12566d28-2fe4-49be-98c9-92787e8dca76.png" class="decor tree" alt="Sapin">
<div class="grid" id="grid"></div>
<div id="note" class="note" style="display:none"><h4>Pense‚Äëb√™te</h4><p id="noteText"></p></div>
<div class="modal" id="modal"><div class="dialog"><h2>üéÅ Votre tirage üéÅ</h2><p id="resultText"></p><button class="closeBtn" id="closeBtn">Fermer</button></div></div>
<audio id="bgm" preload="none" loop></audio>
<button id="audioToggle" class="audio-toggle">üîá</button>
<script>
(function(){
  const NAMES=["PA","Maelle","Antoine","Philippine","Mayeul","Alexis","Ga√´tane","Jo","Hugues","HM","Sixte","Baudouin"];
  const COUPLES=[["PA","Maelle"],["Antoine","Philippine"],["Alexis","Ga√´tane"]];
  const EXC=Object.fromEntries(NAMES.map(n=>[n,new Set()]));
  for(const [a,b] of COUPLES){EXC[a].add(b);EXC[b].add(a);}  
  const LS_ASSIGN='pns_assignment';const LS_REVEALS='pns_reveals';
  const MUSIC_SOURCES=[
    'https://upload.wikimedia.org/wikipedia/commons/3/3e/Church_bells_in_Bucharest.ogg',
    'https://upload.wikimedia.org/wikipedia/commons/f/f0/Christmas_bells.ogg',
    'https://upload.wikimedia.org/wikipedia/commons/9/93/Handbells_Jingle.ogg'];
  const $=s=>document.querySelector(s);
  const grid=$('#grid'),modal=$('#modal'),resultText=$('#resultText'),closeBtn=$('#closeBtn'),note=$('#note'),noteText=$('#noteText'),audio=$('#bgm'),audioToggle=$('#audioToggle');
  function setupAudio(){const pick=MUSIC_SOURCES[Math.floor(Math.random()*MUSIC_SOURCES.length)];audio.src=pick;audio.volume=0.8;}
  let audioEnabled=false;function tryPlayAudio(){if(audioEnabled)return;audioEnabled=true;audio.play().then(()=>{audioToggle.textContent='üîä';}).catch(()=>{audioEnabled=false;});}
  audioToggle.addEventListener('click',()=>{if(audio.paused){tryPlayAudio();}else{audio.pause();audioEnabled=false;audioToggle.textContent='üîá';}});
  function load(k){try{return JSON.parse(localStorage.getItem(k)||'null');}catch{return null;}}
  function save(k,v){localStorage.setItem(k,JSON.stringify(v));}
  function derange(names){const n=names.length;const used=Array(n).fill(false);const res=Array(n).fill(-1);const idx=[...Array(n).keys()];function ok(i,j){if(i===j)return false;const g=names[i],t=names[j];if(EXC[g]&&EXC[g].has(t))return false;return true;}function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}shuffle(idx);function backtrack(p){if(p===n)return true;const i=idx[p];const choices=[...Array(n).keys()];shuffle(choices);for(const j of choices){if(!used[j]&&ok(i,j)){res[i]=j;used[j]=true;if(backtrack(p+1))return true;used[j]=false;res[i]=-1;}}return false;}if(backtrack(0)){const map={};for(let i=0;i<n;i++)map[names[i]]=names[res[i]];return map;}return null;}
  let ASSIGN=load(LS_ASSIGN);if(!ASSIGN){for(let t=0;t<400;t++){const a=derange(NAMES);if(a){ASSIGN=a;break;}}if(ASSIGN)save(LS_ASSIGN,ASSIGN);}
  function build(){const reveals=load(LS_REVEALS)||{};grid.innerHTML='';NAMES.forEach((name,i)=>{const b=document.createElement('button');b.className='nameBtn';b.textContent=name;b.addEventListener('click',()=>{tryPlayAudio();reveal(name,b);});if(reveals[name])b.disabled=true;grid.appendChild(b);});updateNote();}
  function reveal(giver,btn){const reveals=load(LS_REVEALS)||{};const t=ASSIGN[giver];if(!t)return;resultText.innerHTML=`${giver} ‚Üí <strong>${t}</strong>`;modal.classList.add('open');btn.disabled=true;reveals[giver]=t;save(LS_REVEALS,reveals);updateNote();}
  function updateNote(){const reveals=load(LS_REVEALS)||{};const keys=Object.keys(reveals);if(keys.length===0){note.style.display='none';return;}const g=keys[0];noteText.textContent=`${g} ‚Üí ${reveals[g]}`;note.style.display='block';}
  closeBtn.addEventListener('click',()=>modal.classList.remove('open'));
  modal.addEventListener('click',e=>{if(e.target===modal)modal.classList.remove('open');});
  setupAudio();build();})();
</script>
</body>
</html>
