<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ЖОYEUX НOËL — Восточный стиль</title>
<style>
  body {
    margin:0; height:100%; color:#fff; font-family:'Cinzel','Georgia','Comic Sans MS',serif;
    background:radial-gradient(circle at center,#b00000 0%,#5c0000 60%,#000 100%);
    overflow:hidden; text-align:center;
  }
  .frame {position:fixed;inset:0;border:20px ridge gold;box-shadow:0 0 80px gold inset,0 0 50px red inset;pointer-events:none;}
  h1 {margin:40px 0;font-size:64px;color:#fffbe6;text-shadow:0 0 20px gold,0 0 40px red,0 0 80px gold;letter-spacing:4px;}
  .grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(130px,1fr));gap:10px;max-width:700px;margin:0 auto;}
  .nameBtn {background:conic-gradient(from 0deg,gold,red,gold,red);border:3px double #fff8dc;border-radius:14px;padding:10px;font-size:16px;font-weight:700;cursor:pointer;color:#300;text-shadow:0 0 6px #fff;box-shadow:0 0 10px #fff;}
  .nameBtn:hover{filter:brightness(1.3) saturate(1.5);}
  .decor{position:fixed;z-index:-1;opacity:.9;}
  .left-decor{left:0;bottom:0;width:300px;}
  .angel{display:none;position:fixed;right:0;top:0;width:320px;z-index:5;animation:shine 2s infinite alternate ease-in-out;}
  @keyframes shine {from{filter:brightness(1) drop-shadow(0 0 10px gold);}to{filter:brightness(1.3) drop-shadow(0 0 25px gold);}}
  .tree{bottom:0;left:50%;transform:translateX(-50%);width:400px;}
  .card-result{display:none;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(180deg,#ff0000,#b00000);color:#fff;padding:30px 50px;border-radius:12px;box-shadow:0 0 40px gold inset,0 0 20px #000;border:8px ridge gold;font-size:26px;font-weight:bold;z-index:4;}
</style>
</head>
<body>
<div class="frame"></div>
<h1>ЖОYEUX НOËL</h1>
<img src="b6127f72-7660-40b4-966b-d417f5e93deb.png" class="decor left-decor" alt="Vierge et enfant">
<img src="12566d28-2fe4-49be-98c9-92787e8dca76.png" class="decor tree" alt="Sapin">
<img src="dc05b10f-fb2c-4140-a923-d0c98961cee1.png" class="angel" id="angel" alt="Ange doré">
<div class="grid" id="grid"></div>
<div class="card-result" id="cardResult"></div>
<script>
(function(){
  const NAMES=["PA","Maelle","Antoine","Philippine","Mayeul","Alexis","Gaëtane","Jo","Hugues","HM","Sixte","Baudouin"];
  const COUPLES=[["PA","Maelle"],["Antoine","Philippine"],["Alexis","Gaëtane"]];
  const EXC=Object.fromEntries(NAMES.map(n=>[n,new Set()]));
  for(const [a,b] of COUPLES){EXC[a].add(b);EXC[b].add(a);}  
  const LS_ASSIGN='pns_assignment';const LS_REVEALS='pns_reveals';
  const $=s=>document.querySelector(s);
  const grid=$('#grid');
  const card=$('#cardResult');
  const angel=$('#angel');
  function load(k){try{return JSON.parse(localStorage.getItem(k)||'null');}catch{return null;}}
  function save(k,v){localStorage.setItem(k,JSON.stringify(v));}
  function derange(names){const n=names.length;const used=Array(n).fill(false);const res=Array(n).fill(-1);const idx=[...Array(n).keys()];function ok(i,j){if(i===j)return false;const g=names[i],t=names[j];if(EXC[g]&&EXC[g].has(t))return false;return true;}function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}}shuffle(idx);function backtrack(p){if(p===n)return true;const i=idx[p];const choices=[...Array(n).keys()];shuffle(choices);for(const j of choices){if(!used[j]&&ok(i,j)){res[i]=j;used[j]=true;if(backtrack(p+1))return true;used[j]=false;res[i]=-1;}}return false;}if(backtrack(0)){const map={};for(let i=0;i<n;i++)map[names[i]]=names[res[i]];return map;}return null;}
  let ASSIGN=load(LS_ASSIGN);if(!ASSIGN){for(let t=0;t<400;t++){const a=derange(NAMES);if(a){ASSIGN=a;break;}}if(ASSIGN)save(LS_ASSIGN,ASSIGN);}
  function build(){const reveals=load(LS_REVEALS)||{};grid.innerHTML='';NAMES.forEach((name,i)=>{const b=document.createElement('button');b.className='nameBtn';b.textContent=name;b.addEventListener('click',()=>{reveal(name,b);});if(reveals[name])b.disabled=true;grid.appendChild(b);});showCard();}
  function reveal(giver,btn){const reveals=load(LS_REVEALS)||{};const t=ASSIGN[giver];if(!t)return;btn.disabled=true;reveals[giver]=t;save(LS_REVEALS,reveals);showCard();}
  function showCard(){const reveals=load(LS_REVEALS)||{};const keys=Object.keys(reveals);if(keys.length===0){card.style.display='none';angel.style.display='none';return;}const g=keys[0];card.textContent=`${
